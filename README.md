# ü§ñ Telegram Control Agent ‚Äî Telegram Bot –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º

**–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram –±–æ—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Ubuntu —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ Telegram.**

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å](#-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞](#-–∫–æ–º–∞–Ω–¥—ã-–±–æ—Ç–∞)
- [–û—á–∏—Å—Ç–∫–∞ –∫–∞–Ω–∞–ª–æ–≤](#-–æ—á–∏—Å—Ç–∫–∞-—Å—Ç–∞—Ä—ã—Ö-—Å–æ–æ–±—â–µ–Ω–∏–π)
- [–î–µ–ø–ª–æ–π](#-–¥–µ–ø–ª–æ–π)

---

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- üìä **–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞** ‚Äî CPU, RAM, Disk, Network –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üîß **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏** ‚Äî –∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
- üîå **–û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã** ‚Äî —Å–ø–∏—Å–æ–∫ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- üåê **–ü–∏–Ω–≥ —Ö–æ—Å—Ç–æ–≤** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- üìã **–õ–æ–≥–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ –ª—é–±–æ–π —Å–ª—É–∂–±—ã

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ö†Ô∏è **–ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ** ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ (CPU, RAM, Disk)
- üìÖ **–î–Ω–µ–≤–Ω—ã–µ –æ—Ç—á—ë—Ç—ã** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞ –¥–µ–Ω—å
- üîî **–û–ø–æ–≤–µ—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª—ã** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö —á–∞—Ç–∞—Ö

### SSH & –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- üîê **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSH** ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–∏
- üîë **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ SSH –∫–ª—é—á–µ–π** ‚Äî –ø—Ä—è–º–æ –∏–∑ –±–æ—Ç–∞ –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- üîí **–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤** ‚Äî —É–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–Ω–∏–º–∞—é—â–∏–µ –ø–æ—Ä—Ç
- üöÄ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±** ‚Äî —Å–ø–∏—Å–æ–∫ —Å–ª—É–∂–± –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- ‚è∞ **–ê–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** ‚Äî –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 4:00)
- üì¢ **–†–∞—Å—Å—ã–ª–∫–∞ –≤ –∫–∞–Ω–∞–ª—ã** ‚Äî –æ–¥–∏–Ω –∫–ª–∏–∫ —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤–æ –≤—Å–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ —á–∞—Ç—ã
- üßπ **–û—á–∏—Å—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** ‚Äî —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–Ω–µ–π
- üíæ **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤** ‚Äî –æ—Ç–ø—Ä–∞–≤—å —Ñ–∞–π–ª –±–æ—Ç—É –∏ –æ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/opt/tg-control-agent/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py                  # –ö–æ–Ω—Ñ–∏–≥ (BOT_TOKEN, ADMIN_IDS, UPDATE_INTERVAL)
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ controller.py          # SSH, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ monitor/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ server.py              # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: CPU, RAM, –ª–æ–≥–∏, –ø–∏–Ω–≥, –ø–æ—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ status_store.py        # –•—Ä–∞–Ω–∏–ª–∏—â–µ ID –∫–∞–Ω–∞–ª–æ–≤, –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∏—Å—Ç–æ—Ä–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ telegram/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ handlers.py            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –∫–Ω–æ–ø–æ–∫
‚îÇ       ‚îú‚îÄ‚îÄ keyboards.py           # –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é
‚îÇ       ‚îî‚îÄ‚îÄ formatter.py           # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (–∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥)
‚îú‚îÄ‚îÄ .env                           # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (BOT_TOKEN, UPDATE_INTERVAL)
‚îú‚îÄ‚îÄ .env.example                   # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ install.sh                     # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º
‚îú‚îÄ‚îÄ status_messages.json           # –§–∞–π–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è (ID –∫–∞–Ω–∞–ª–æ–≤, —Å–æ–æ–±—â–µ–Ω–∏–π, –Ω–∞—Å—Ç—Ä–æ–µ–∫)
‚îú‚îÄ‚îÄ venv/                          # Virtual environment (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ /tmp/tg_uploads/              # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–í–ê–ñ–ù–û: –ù–∞ GitHub –ù–ï –∫–æ–º–º–∏—Ç–∏–º:
  ‚ùå .env (—Å–æ–¥–µ—Ä–∂–∏—Ç BOT_TOKEN!)
  ‚ùå status_messages.json (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞)
  ‚ùå venv/ (virtual environment)
  ‚úÖ .env.example (–ø—Ä–∏–º–µ—Ä –¥–ª—è –¥—Ä—É–≥–∏—Ö)
```

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ù–∞ —Å–µ—Ä–≤–µ—Ä (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/tarpy-socdev/Telegram-control-agent.git /opt/tg-control-agent
cd /opt/tg-control-agent

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞
sudo ./install.sh install

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º
sudo ./install.sh configure
# –í–≤–æ–¥–∏–º:
#   BOT_TOKEN: 7851126415:AAH1yKpCvlAIspUMXybMcgOTjwVlH8oGNtw
#   ADMIN_IDS: 5805064246,12345678
#   UPDATE_INTERVAL: 30

# –ó–∞–ø—É—Å–∫–∞–µ–º
sudo ./install.sh start

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
sudo ./install.sh logs 20
```

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
git clone https://github.com/tarpy-socdev/Telegram-control-agent.git
cd Telegram-control-agent

# –ö–æ–ø–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞
cp .env.example .env
nano .env  # –í–≤–æ–¥–∏–º BOT_TOKEN –∏ ADMIN_IDS

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
python3 -m bot.main
```

---

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ `/start` –∏–ª–∏ –Ω–∞–∂–∞—Ç–∏–∏ "üè† –ì–ª–∞–≤–Ω–∞—è":

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  üñ•Ô∏è  –°–¢–ê–¢–£–° –°–ï–†–í–ï–†–ê
‚ïë  14:25:30
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚è±Ô∏è –ê–ø—Ç–∞–π–º: 5–¥ 3—á 47–º
üìä Load: 0.12 0.15 0.08

üìà –†–ï–°–£–†–°–´
üü¢ CPU: 12.5%
üü¢ RAM: 45.3% (1.7/3.8 GB)
üü¢ Disk: 16.2% (4.8/29.4 GB)
üåê Net: ‚¨áÔ∏è1.2MB ‚¨ÜÔ∏è0.3MB

üîß –°–õ–£–ñ–ë–´ (5)
  ‚úÖ ssh
  ‚úÖ docker
  ...

üîå –ü–û–†–¢–´ (4)
  ‚Ä¢ 22 ‚Äî sshd
  ‚Ä¢ 80 ‚Äî nginx
  ...
```

–ö–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É:
- üìä –û–±–Ω–æ–≤–∏—Ç—å ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
- üîß –°–ª—É–∂–±—ã ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–ª—É–∂–±
- üîå –ü–æ—Ä—Ç—ã ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
- üåê –ü–∏–Ω–≥ ‚Äî –ø–∏–Ω–≥ —Ö–æ—Å—Ç–∞
- üìã –õ–æ–≥–∏ ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- üîê SSH ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSH
- üîÅ Reboot ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

---

## ‚å®Ô∏è –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º |
| `/status` | –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ |
| `/services` | –°–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–± |
| `/ports` | –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã |
| `/ping google.com` | –ü–∏–Ω–≥ —Ö–æ—Å—Ç–∞ |
| `/logs ssh 50` | –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤ ssh |
| `/restart_service ssh` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º) |
| `/reboot` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ—Ä–≤–µ—Ä |
| `/close_port 8080` | –ó–∞–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 8080 |

### SSH & –ö–ª—é—á–∏

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/add_ssh_key ssh-ed25519 AAAA... --user tarpy` | –î–æ–±–∞–≤–∏—Ç—å SSH –∫–ª—é—á –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `/ssh_list` | –°–ø–∏—Å–æ–∫ SSH –∫–ª—é—á–µ–π –≤ authorized_keys |

### –ö–∞–Ω–∞–ª—ã & –û–ø–æ–≤–µ—â–µ–Ω–∏—è

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/link_channel -100123456789` | –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫–∞–Ω–∞–ª (–Ω—É–∂–µ–Ω ID) |
| `/unlink_channel` | –û—Ç–≤—è–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —á–∞—Ç –æ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| `/broadcast –¢–µ–∫—Å—Ç` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–æ –≤—Å–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã |
| `/set_alerts 5 10 15` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ä–æ–≥–∏ –∞–ª–µ—Ä—Ç–æ–≤ (CPU RAM Disk) |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/clear_logs` | –û—á–∏—Å—Ç–∏—Ç—å journalctl –ª–æ–≥–∏ |
| `/test_update` | –°—Ä–∞–∑—É –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤–æ –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–∞—Ö |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º |

---

## üßπ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–ò—Å–ø–æ–ª—å–∑—É–π —Å–∫—Ä–∏–ø—Ç `cleanup_channels.py`:

```bash
# –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –±–æ–ª–µ–µ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
python3 cleanup_channels.py "7851126415:AAH..." 7

# –£–¥–∞–ª–∏—Ç—å –í–°–ï —Å–æ–æ–±—â–µ–Ω–∏—è
python3 cleanup_channels.py "7851126415:AAH..." all

# –ò–ª–∏ —á–µ—Ä–µ–∑ –±–æ—Ç ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –û—á–∏—Å—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è ‚Üí –≤—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ë–æ—Ç —Ö—Ä–∞–Ω–∏—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –¥–∞—Ç—É –∫–æ–≥–¥–∞ –æ–Ω —Ç—É–¥–∞ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω (–≤ `status_messages.json`)
2. –ü—Ä–∏ –æ—á–∏—Å—Ç–∫–µ ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞—Ç—É –∏ —É–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞ –µ—Å–ª–∏ –æ–Ω–∏ —Å—Ç–∞—Ä—à–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
3. –•—Ä–∞–Ω–∏—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:
   ```json
   {
     "channels": {
       "-100123456789": {
         "msg_id": 42,
         "added": "2026-02-27T08:45:00"
       }
     }
   }
   ```

---

## üöÄ –î–µ–ø–ª–æ–π (—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ)

### –ß–µ—Ä–µ–∑ `deploy.sh` –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

```bash
# –°–∫–æ–ø–∏—Ä—É–π deploy.sh –∏ update_bot_final.py –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
chmod +x deploy.sh

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –∫–æ–Ω—Ñ–∏–≥ –≤ deploy.sh –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
# SERVER="tarpy@82.202.158.235"

# –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—ã:

# 1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ GitHub
./deploy.sh push

# 2Ô∏è‚É£ –û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
./deploy.sh pull

# 3Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç
./deploy.sh restart

# 4Ô∏è‚É£ –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
./deploy.sh logs

# 5Ô∏è‚É£ –í—Å—ë –≤–º–µ—Å—Ç–µ (push + pull + restart)
./deploy.sh full
```

### –í—Ä—É—á–Ω—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd /opt/tg-control-agent

# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç
./install.sh stop

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
curl -sO https://raw.githubusercontent.com/tarpy-socdev/Telegram-control-agent/main/update_bot_final.py

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
python3 update_bot_final.py

# 4. –ò–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sed -i 's/UPDATE_INTERVAL=30/UPDATE_INTERVAL=60/' .env

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç
./install.sh start

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
./install.sh logs 20
```

---

## üìä –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `.env`

```bash
# –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
BOT_TOKEN=7851126415:AAH1yKpCvlAIspUMXybMcgOTjwVlH8oGNtw

# ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±–æ—Ç–∞ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
ADMIN_IDS=5805064246,12345678

# –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–º–∏–Ω–∏–º—É–º 30)
UPDATE_INTERVAL=30
```

**‚ö†Ô∏è –í–ê–ñ–ù–û: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ .env –Ω–∞ GitHub! –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç BOT_TOKEN!**

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–π—Ç–µ `.env.example`:
```bash
BOT_TOKEN=YOUR_BOT_TOKEN_HERE
ADMIN_IDS=YOUR_ADMIN_ID
UPDATE_INTERVAL=30
```

---

## üìä –§–∞–π–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è `status_messages.json`

–•—Ä–∞–Ω–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –±–æ—Ç–∞:

```json
{
  "channels": {
    "-100123456789": {
      "msg_id": 42,
      "added": "2026-02-27T08:45:00"
    },
    "5805064246": {
      "msg_id": 128,
      "added": "2026-02-26T16:45:00"
    }
  },
  "settings": {
    "show_services": true,
    "show_ports": false,
    "alerts_enabled": true,
    "alert_cpu": 80,
    "alert_ram": 85,
    "daily_report_enabled": false,
    "daily_report_time": "09:00",
    "auto_reboot_enabled": false,
    "auto_reboot_time": "04:00"
  },
  "alerts": {
    "-100123456789_cpu": 45.2,
    "-100123456789_ram": 62.3
  }
}
```

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –°—Ç–∞—Ç—É—Å
sudo systemctl status tg-control-agent

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo journalctl -u tg-control-agent -f

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
cd /opt/tg-control-agent
./install.sh logs 50        # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
./install.sh logs-live      # –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
./install.sh restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./install.sh stop

# –ó–∞–ø—É—Å–∫
./install.sh start

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
./install.sh diagnose
```

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω
sudo systemctl status tg-control-agent

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
sudo journalctl -u tg-control-agent -n 100

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
cd /opt/tg-control-agent && ./install.sh restart
```

### –°—Ç–∞—Ç—É—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ –∫–∞–Ω–∞–ª–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
cat /opt/tg-control-agent/status_messages.json | jq '.channels'

# –ü–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
# /test_update –≤ –±–æ—Ç–µ

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
python3 << 'EOF'
import json
import subprocess
data = json.load(open("status_messages.json"))
print(f"–ü—Ä–∏–≤—è–∑–∞–Ω–æ –∫–∞–Ω–∞–ª–æ–≤: {len(data.get('channels', {}))}")
for chat_id, msg_info in data.get("channels", {}).items():
    print(f"  - {chat_id}: message_id={msg_info.get('msg_id')}")
EOF
```

### SSH –Ω–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl status ssh.socket ssh

# –û—Ç–∫–ª—é—á–∏—Ç—å –≤—Ä—É—á–Ω—É—é
systemctl stop ssh.socket ssh
systemctl disable ssh.socket ssh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ—Ç–∫–ª—é—á–∏–ª–æ—Å—å
systemctl is-active ssh
```

---

## üìù –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

| –§–∞–π–ª | –ß—Ç–æ —ç—Ç–æ |
|------|---------|
| `bot/main.py` | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è job_queue |
| `bot/config.py` | –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ –∏–∑ .env |
| `bot/monitor/server.py` | –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ |
| `bot/core/controller.py` | SSH, systemctl, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ |
| `bot/storage/status_store.py` | –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏ —Ä–∞–±–æ—Ç–∞ —Å JSON |
| `bot/telegram/handlers.py` | –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (2000+ —Å—Ç—Ä–æ–∫) |
| `bot/telegram/keyboards.py` | –í—Å–µ –∫–Ω–æ–ø–∫–∏ –∏ –º–µ–Ω—é |
| `bot/telegram/formatter.py` | –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π |
| `install.sh` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ |
| `requirements.txt` | Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| `update_bot_final.py` | –°–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ |
| `cleanup_channels.py` | –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ |
| `deploy.sh` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π |

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~3000 Python + ~200 Bash
- **–ö–æ–º–∞–Ω–¥:** 15+ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- **–§—É–Ω–∫—Ü–∏–π:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **Python –≤–µ—Ä—Å–∏—è:** 3.8+
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** python-telegram-bot, psutil, –∏ –¥—Ä—É–≥–∏–µ

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –∫–∞–∫ —Ö–æ—á–µ—à—å

---

## üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–°–æ–∑–¥–∞–π issue –Ω–∞ GitHub –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

**–°–æ–∑–¥–∞–Ω–æ –¥–ª—è üñ•Ô∏è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ Telegram üì±**
